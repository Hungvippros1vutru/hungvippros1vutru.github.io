<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ğŸ§ Hung Music Player</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:url("background.jpg") no-repeat center/cover;
  backdrop-filter:blur(5px);
  color:white;
  text-align:center;
}

.container{
  margin:50px auto;
  width:400px;
  background:rgba(0,0,0,0.6);
  padding:20px;
  border-radius:20px;
}

h2{margin-bottom:10px}

button{
  padding:8px 12px;
  margin:4px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}

input[type=range]{
  width:100%;
}

.playlist{
  text-align:left;
  max-height:200px;
  overflow-y:auto;
  margin-top:10px;
}

.song-item{
  padding:5px;
  cursor:pointer;
}

.song-item:hover{
  background:rgba(255,255,255,0.2);
}
.active{
  color:#00ffcc;
}
</style>
</head>

<body>

<div class="container">
  <h2 id="songTitle">Äang táº£i...</h2>

  <audio id="player"></audio>

  <div>
    <button onclick="prev()">â®</button>
    <button onclick="togglePlay()">â–¶ / â¸</button>
    <button onclick="next()">â­</button>
    <button onclick="shuffleToggle()">ğŸ”€</button>
    <button onclick="repeatToggle()">ğŸ”</button>
  </div>

  <input type="range" id="progress" value="0">
  <input type="range" id="volume" min="0" max="1" step="0.01" value="1">

  <div class="playlist" id="playlistUI"></div>
</div>

<script>
const USERNAME = "hungvippros1vutru";
const REPO = "hungvippros1vutru.github.io";

const player = document.getElementById("player");
const title = document.getElementById("songTitle");
const playlistUI = document.getElementById("playlistUI");
const progress = document.getElementById("progress");
const volume = document.getElementById("volume");

let playlist = [];
let index = 0;
let isShuffle = false;
let isRepeat = false;

async function loadSongs(){
  const res = await fetch(
    `https://api.github.com/repos/${USERNAME}/${REPO}/contents/`
  );
  const data = await res.json();

  playlist = data
    .filter(f => f.name.endsWith(".mp3"))
    .map(f => ({
      name: f.name,
      url: f.download_url
    }));

  renderPlaylist();
  if(playlist.length>0){
    loadSong(0);
  } else {
    title.innerText = "âŒ KhÃ´ng cÃ³ mp3";
  }
}

function renderPlaylist(){
  playlistUI.innerHTML="";
  playlist.forEach((song,i)=>{
    const div=document.createElement("div");
    div.className="song-item";
    div.innerText=song.name;
    div.onclick=()=>loadSong(i);
    playlistUI.appendChild(div);
  });
}

function loadSong(i){
  index=i;
  player.src=playlist[index].url;
  title.innerText="ğŸµ "+playlist[index].name;
  highlight();
  player.play();
}

function highlight(){
  document.querySelectorAll(".song-item").forEach((el,i)=>{
    el.classList.toggle("active",i===index);
  });
}

function togglePlay(){
  if(player.paused) player.play();
  else player.pause();
}

function next(){
  if(isShuffle){
    index=Math.floor(Math.random()*playlist.length);
  } else {
    index=(index+1)%playlist.length;
  }
  loadSong(index);
}

function prev(){
  index=(index-1+playlist.length)%playlist.length;
  loadSong(index);
}

function shuffleToggle(){
  isShuffle=!isShuffle;
  alert("Shuffle: "+isShuffle);
}

function repeatToggle(){
  isRepeat=!isRepeat;
  alert("Repeat: "+isRepeat);
}

player.addEventListener("ended",()=>{
  if(isRepeat){
    loadSong(index);
  } else {
    next();
  }
});

player.addEventListener("timeupdate",()=>{
  progress.value=(player.currentTime/player.duration)*100 || 0;
});

progress.addEventListener("input",()=>{
  player.currentTime=(progress.value/100)*player.duration;
});

volume.addEventListener("input",()=>{
  player.volume=volume.value;
});

loadSongs();
</script>

</body>
</html>
